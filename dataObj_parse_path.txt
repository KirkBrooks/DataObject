  //  dataObj_parse_path  // Written by: Kirk Brooks as Designer, Created: 07/07/17, 11:02:21  // ------------------  // Method: dataObj_parse_path (text; ptr; ptr)  // $1 is a path  // $2 is ptr to key array       (text)  // $3 is ptr to array dim array (long)  // Purpose: parse the dot notation path into key and array dim arraysC_TEXT($path;$1)C_POINTER($2;$3)C_LONGINT($i;$n;$pos;$len)C_TEXT($key)$path:=$1ARRAY TEXT($aPath;0)ARRAY LONGINT($aIndex;0)$n:=Length($path)If ($n>0)  //  verify the path does not end with a dotIf ($path[[$n]]=".")$path:=Substring($path;1;$n-1)End if While ($path#"")$pos:=Position(".";$path)  // where is the next dot?Case of : ($pos>0)$key:=Substring($path;1;$pos-1)$path:=Substring($path;$pos+1)  // is this an array? If (Match regex("\\[\\d+\\]";$key;1;$pos;$len))$i:=Num(Substring($key;$pos))  // ignores the brackets$key:=Substring($key;1;$pos-1)Else $i:=-1End if APPEND TO ARRAY($aPath;$key)APPEND TO ARRAY($aIndex;$i): ($pos=0) & ($path#"")  // the final element$key:=$path$path:=""  // or else we never stop  // is this an array? If (Match regex("\\[\\d+\\]";$key;1;$pos;$len))$i:=Num(Substring($key;$pos))  // ignores the brackets$key:=Substring($key;1;$pos-1)Else $i:=-1End if APPEND TO ARRAY($aPath;$key)APPEND TO ARRAY($aIndex;$i)End case End while End if COPY ARRAY($aPath;$2->)COPY ARRAY($aIndex;$3->)